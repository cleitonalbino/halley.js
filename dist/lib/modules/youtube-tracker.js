'use strict';function YtTracking(a,b){if(null===a||a===void 0){throw new Error("Missing player object")}if(null===b.callback||"function"!=typeof b.callback){throw new Error("Missing the callback function")}this.player=a,this.trackValues=b.trackings||["0%","25%","50%","75%","100%"],this.callback=b.callback,this.trackList=[],this.videoTimer=null,this.setupTrackList()}YtTracking.prototype.setupTrackList=function(){for(var a=0,b=this.trackValues.length;a<b;a++)this.trackList[this.trackValues[a]]=!1},YtTracking.prototype.onVideoStateChange=function(a){switch(a){case YT.PlayerState.PLAYING:this.startVideoTimer();break;case YT.PlayerState.ENDED:this.verifyVideoTime(),this.stopVideoTimer();break;default:this.stopVideoTimer();}},YtTracking.prototype.startVideoTimer=function(){var a=this;this.videoTimer=setInterval(function(){a.verifyVideoTime()},1e3)},YtTracking.prototype.stopVideoTimer=function(){clearInterval(this.videoTimer)},YtTracking.prototype.verifyVideoTime=function(){var b,c,d,e,a=Math.round,f=0;b=this.player.getDuration(),c=a(this.player.getCurrentTime());for(var g=0,h=this.trackValues.length;g<h;g++)d=this.trackValues[g].substr(this.trackValues[g].length-1),e=this.trackValues[g].replace(/[a-z]/g,""),"p"===d?(f=a(100*c/b),f>=e&&!1===this.trackList[this.trackValues[g]]&&this.refreshTrackList(this.trackValues[g])):"s"===d&&c>=e&&!1===this.trackList[this.trackValues[g]]&&this.refreshTrackList(this.trackValues[g])},YtTracking.prototype.refreshTrackList=function(a){this.trackList[a]=!0,this.publish(a)},YtTracking.prototype.publish=function(a){this.callback&&"function"==typeof this.callback&&this.callback(a)},module.exports=YtTracking;
